<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<title>For Surbhi ❤️</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&display=swap');

  html, body {
    margin: 0;
    padding: 0;
    background: #050505; /* Very dark grey */
    overflow: hidden;
    font-family: 'Fira Code', monospace; /* Coding font style */
    touch-action: none;
  }

  canvas {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1;
  }

  /* Container for the text at the bottom */
  #text-container {
    position: absolute;
    bottom: 8%; /* Slightly higher up */
    left: 0;
    width: 100%;
    text-align: center;
    z-index: 2;
    pointer-events: none;
  }

  /* The glowing text style */
  #typewriter {
    font-size: clamp(22px, 6vw, 45px); /* Responsive size, slightly bigger */
    color: #ff4d6d;
    text-shadow: 0 0 10px #ff4d6d, 0 0 25px #ff0040; /* Stronger Glow */
    display: inline-block;
    white-space: nowrap;
    font-weight: bold;
    letter-spacing: 1px;
  }

  /* The blinking cursor at the end */
  .cursor {
    display: inline-block;
    width: 3px;
    height: 1.2em;
    background-color: #ff4d6d;
    margin-left: 5px;
    vertical-align: bottom;
    animation: blink 1s infinite;
    box-shadow: 0 0 15px #ff4d6d;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  #start {
    position: fixed;
    inset: 0;
    background: #000;
    color: #ff4d6d;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    z-index: 10;
    cursor: pointer;
    transition: opacity 1s;
  }
  
  .heart-beat { animation: beat 1s infinite; }
  @keyframes beat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
  }
</style>
</head>

<body>

<div id="start">
  <div class="heart-beat" style="font-size: 50px;">❤️</div>
  <p style="margin-top:15px">Tap for Surbhi</p>
</div>

<canvas id="c"></canvas>

<div id="text-container">
  <span id="typewriter"></span><span class="cursor"></span>
</div>

<audio id="music" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
// --- Canvas Setup ---
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// --- Configuration ---
let turtle = { x: 0, y: 0, a: -90 };
let queue = [];
const message = "Surbhi ❤️ love you"; // The text to type
let textIndex = 0;

// --- Turtle Functions (Tree Drawing) ---
function resetTurtle() {
  // Start tree from bottom center
  turtle = { x: canvas.width / 2, y: canvas.height * 0.85, a: -90 }; 
}

function f(dist, color, width) {
  queue.push(() => {
    ctx.beginPath();
    ctx.strokeStyle = color;
    ctx.lineWidth = width;
    ctx.lineCap = "round";
    ctx.moveTo(turtle.x, turtle.y);
    
    let rad = turtle.a * (Math.PI / 180);
    let nx = turtle.x + Math.cos(rad) * dist;
    let ny = turtle.y + Math.sin(rad) * dist;
    
    ctx.lineTo(nx, ny);
    ctx.stroke();
    
    turtle.x = nx;
    turtle.y = ny;
  });
}

function l(angle) { queue.push(() => turtle.a -= angle); }
function r(angle) { queue.push(() => turtle.a += angle); }

function dot() {
  queue.push(() => {
    ctx.fillStyle = "#ff0040";
    ctx.beginPath();
    ctx.arc(turtle.x, turtle.y, 3.5, 0, Math.PI * 2); // Slightly bigger dots
    ctx.fill();
    ctx.shadowBlur = 15;
    ctx.shadowColor = "#ff0040";
    ctx.fill();
    ctx.shadowBlur = 0;
  });
}

// --- Recursive Tree Logic ---
function tree(len, depth) {
  if (len < 10 || depth > 10) {
    dot();
    return;
  }

  let width = Math.max(0.5, len / 15);
  // Color gradients from pink to deep red
  let color = `hsl(${335 + depth * 3}, 90%, ${60 + depth * 2}%)`;

  f(len, color, width);

  let savedState = null;
  queue.push(() => { savedState = { ...turtle }; });

  l(25);
  tree(len * 0.75, depth + 1);

  queue.push(() => { turtle = { ...savedState }; });

  r(50);
  tree(len * 0.75, depth + 1);

  queue.push(() => { turtle = { ...savedState }; });
}

// --- Typewriter Effect Function ---
function typeWriter() {
  if (textIndex < message.length) {
    document.getElementById("typewriter").innerHTML += message.charAt(textIndex);
    textIndex++;
    // Typing speed (lower number = faster)
    setTimeout(typeWriter, 120); 
  }
}

// --- Main Animation Loop (Tree) ---
function animateTree() {
  // Draw multiple steps per frame for smoother speed
  for(let i=0; i<5; i++){
    if (queue.length > 0) {
      let task = queue.shift();
      task();
    }
  }

  if (queue.length > 0) {
    requestAnimationFrame(animateTree);
  }
}

// --- Start Interaction ---
document.getElementById("start").onclick = function() {
  const startScreen = document.getElementById("start");
  const audio = document.getElementById("music");
  
  startScreen.style.opacity = 0;
  setTimeout(() => startScreen.remove(), 1000);

  // 1. Play music
  audio.volume = 0.6;
  audio.play().catch(console.error);

  // 2. Start drawing the Tree immediately
  resetTurtle();
  tree(canvas.height * 0.20, 0); 
  animateTree();

  // 3. Start typing the Text immediately (with a tiny 0.5s delay for effect)
  setTimeout(typeWriter, 500);
};

</script>
</body>
</html>
