<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>For Surbhi ❤️</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: black;
    overflow: hidden;
    touch-action: none; /* Prevent zooming on mobile */
    font-family: 'Courier New', Courier, monospace;
  }

  canvas {
    display: block;
  }

  #start {
    position: fixed;
    inset: 0;
    background: black;
    color: #ff4d6d;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    z-index: 10;
    cursor: pointer;
    transition: opacity 1s;
  }

  .pulse {
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
    100% { transform: scale(1); opacity: 1; }
  }
</style>
</head>

<body>

<div id="start">
  <div class="pulse">Tap for a surprise ❤️</div>
</div>

<canvas id="c"></canvas>

<audio id="music" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

// Responsive Canvas
function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// Turtle State
let turtle = { x: 0, y: 0, a: -90 }; // Angle -90 is straight up
let queue = [];

// Configuration
ctx.lineCap = "round";

// --- Turtle Helper Functions ---
function resetTurtle() {
  turtle = { x: canvas.width / 2, y: canvas.height * 0.85, a: -90 };
}

function f(dist, color, width) {
  queue.push(() => {
    ctx.beginPath();
    ctx.strokeStyle = color;
    ctx.lineWidth = width;
    ctx.moveTo(turtle.x, turtle.y);
    
    // Calculate new position
    let rad = turtle.a * (Math.PI / 180);
    let nx = turtle.x + Math.cos(rad) * dist;
    let ny = turtle.y + Math.sin(rad) * dist;
    
    ctx.lineTo(nx, ny);
    ctx.stroke();
    
    // Update turtle position
    turtle.x = nx;
    turtle.y = ny;
  });
}

function l(angle) { queue.push(() => turtle.a -= angle); }
function r(angle) { queue.push(() => turtle.a += angle); }

function dot() {
  queue.push(() => {
    ctx.fillStyle = "#ff0040"; // Bright red/pink tip
    ctx.beginPath();
    ctx.arc(turtle.x, turtle.y, 3, 0, Math.PI * 2);
    ctx.fill();
    // Add a glow effect
    ctx.shadowBlur = 10;
    ctx.shadowColor = "#ff0040";
    ctx.fill();
    ctx.shadowBlur = 0;
  });
}

// --- Recursive Tree Logic ---
function tree(len, depth) {
  if (len < 10 || depth > 10) {
    dot();
    return;
  }

  // Branch thickness gets thinner as we go up
  let width = Math.max(0.5, len / 15);
  // Color gradient from dark red to pink
  let color = `hsl(${340 + depth * 2}, 80%, ${50 + depth * 3}%)`;

  f(len, color, width);

  // Save state (virtual stack)
  let savedState = null;
  queue.push(() => { savedState = { ...turtle }; });

  l(25);
  tree(len * 0.75, depth + 1);

  // Restore state
  queue.push(() => { turtle = { ...savedState }; });

  r(50); // Asymmetrical tree looks more organic (like the screenshot)
  tree(len * 0.75, depth + 1);

  // Restore state
  queue.push(() => { turtle = { ...savedState }; });
}

// --- Text Animation ---
function drawText() {
  queue.push(() => {
    ctx.font = "bold 30px 'Courier New', monospace";
    ctx.fillStyle = "#ff4d6d";
    ctx.textAlign = "center";
    ctx.shadowColor = "#ff4d6d";
    ctx.shadowBlur = 20;
    ctx.fillText("Surbhi ❤️ Love You", canvas.width / 2, canvas.height * 0.95);
    ctx.shadowBlur = 0;
  });
}

// --- Animation Loop ---
function animate() {
  // Process up to 5 steps per frame to speed up the drawing slightly
  let speed = 5; 
  for(let i=0; i<speed; i++){
    if (queue.length > 0) {
      let task = queue.shift();
      task();
    }
  }
  
  if (queue.length > 0) {
    requestAnimationFrame(animate);
  }
}

// --- Initialization ---
document.getElementById("start").onclick = function() {
  const startScreen = document.getElementById("start");
  const audio = document.getElementById("music");
  
  // Fade out start screen
  startScreen.style.opacity = 0;
  setTimeout(() => startScreen.remove(), 1000);

  // Try to play music
  audio.volume = 0.5;
  audio.play().catch(e => console.log("Audio requires interaction or file missing"));

  // Build the Animation Queue
  resetTurtle();
  // Calculate initial tree size based on screen height
  tree(canvas.height * 0.22, 0); 
  drawText();

  // Start Animating
  animate();
};

</script>
</body>
</html>
